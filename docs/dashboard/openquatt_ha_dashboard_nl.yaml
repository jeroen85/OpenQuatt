title: OpenQuatt
views:
  - title: Overzicht
    path: overzicht
    icon: mdi:view-dashboard
    type: sections
    max_columns: 3
    sections:
      - type: grid
        column_span: 1
        cards:
          - type: heading
            icon: mdi:speedometer
            heading: Live prestaties
            heading_style: title
          - type: markdown
            content: >-
              <details>

              <summary><strong>Uitleg</strong></summary>


              Deze waarden geven live de belangrijkste systeemprestatie:

              - `Flow`: actuele volumestroom die als basis dient voor
              flowbewaking.

              - `Power E`: totaal elektrisch ingangsvermogen van de
              warmtepomp(en).

              - `Power H`: totaal thermisch afgegeven vermogen.

              - `COP`: verhouding `Power H / Power E` (momentane efficientie).

              - `Buitentemp`: geselecteerde bron voor buitentemperatuur in de
              regeling.

              - `Aanvoertemperatuur`: geselecteerde bron voor actuele
              watersupply.


              </details>
            text_only: true
          - type: tile
            entity: sensor.openquatt_flow_average_selected
            name: Flow
            vertical: false
            features:
              - type: trend-graph
            features_position: bottom
          - type: tile
            entity: sensor.openquatt_total_power_input
            name: Power E
            vertical: false
            features:
              - type: trend-graph
            features_position: bottom
          - type: tile
            entity: sensor.openquatt_total_heat_power
            name: Power H
            vertical: false
            features:
              - type: trend-graph
            features_position: bottom
          - type: tile
            entity: sensor.openquatt_total_cop
            name: COP
            vertical: false
            features:
              - type: trend-graph
            features_position: bottom
          - type: tile
            entity: sensor.openquatt_outside_temperature_selected
            name: Buitentemp
            vertical: false
            features:
              - type: trend-graph
            features_position: bottom
          - type: tile
            entity: sensor.openquatt_water_supply_temp_selected
            name: Aanvoertemperatuur
            vertical: false
            features:
              - type: trend-graph
            features_position: bottom
      - type: grid
        cards:
          - type: heading
            heading_style: title
            heading: Supervisory status
            icon: mdi:state-machine
          - type: markdown
            content: >-
              <details>

              <summary><strong>Uitleg</strong></summary>


              Dit blok toont de actieve regeltoestand:

              - `Control mode`: huidige bedrijfsmodus/stap van de state machine.

              - `Flow mode`: manier waarop de pomp/flowregeling momenteel werkt.

              - `Heating strategy`: bron van de warmtevraag (bijv. Power
              House/curve).

              - `Boiler active`: geeft aan of ketel-assist actief is.

              - `Silent active`: toont of het stil-venster nu van kracht is.


              </details>
            text_only: true
          - type: tile
            entity: sensor.openquatt_control_mode_label
            name: Control mode
            vertical: false
            features_position: bottom
          - type: tile
            entity: sensor.openquatt_flow_mode
            name: Flow mode
            vertical: false
            features_position: bottom
          - type: tile
            entity: sensor.openquatt_heating_strategy
            name: Heating strategy
            vertical: false
            features_position: bottom
          - type: tile
            entity: binary_sensor.openquatt_boiler_active
            name: Boiler active
            vertical: false
            features_position: bottom
          - type: tile
            entity: binary_sensor.openquatt_silent_active
            name:
              type: entity
            vertical: false
            features_position: bottom
          - type: heading
            icon: mdi:stethoscope
            heading: Debug
            heading_style: title
          - type: markdown
            content: >-
              <details>

              <summary><strong>Uitleg</strong></summary><ha-alert
              alert-type="warning">Pas op, dit overruled de ControlMode van
              OpenQuatt!</ha-alert>


              `CM override`: handmatige mode-override; normaal op `Auto` laten.


              </details>
            text_only: true
          - type: tile
            entity: select.openquatt_cm_override
            name:
              type: entity
            hide_state: true
            vertical: false
            features:
              - type: select-options
            features_position: inline
      - type: grid
        cards:
          - type: heading
            heading: Thermostaat
            heading_style: title
            icon: mdi:home-thermometer
          - type: markdown
            content: >-
              <details>

              <summary><strong>Uitleg</strong></summary>


              Geselecteerde kamerregelwaarden:

              - `Setpoint`: gevraagde ruimtetemperatuur.

              - `Huidige temperatuur`: gemeten ruimtetemperatuur.

              Het verschil tussen deze twee bepaalt hoe sterk de warmtevraag
              oploopt.


              </details>
            text_only: true
          - type: tile
            entity: sensor.openquatt_room_temperature_selected
            name: Huidige temperatuur
            vertical: false
            features:
              - type: trend-graph
            features_position: bottom
          - type: tile
            entity: sensor.openquatt_room_setpoint_selected
            name: Setpoint
            vertical: false
            features:
              - type: trend-graph
            features_position: bottom
          - type: heading
            heading_style: title
            heading: Silent mode settings
            icon: mdi:volume-off
          - type: markdown
            content: >-
              <details>

              <summary><strong>Uitleg</strong></summary>


              Dagelijkse instellingen die direct gedrag begrenzen:

              - `Silent end/start time`: tijdvenster voor stille modus.

              - `Day max level`: bovengrens compressorlevel buiten silent-uren.

              - `Silent max level`: bovengrens compressorlevel tijdens
              silent-uren.


              </details>
            text_only: true
          - type: tile
            entity: time.openquatt_silent_end_time
            name:
              type: entity
            vertical: false
          - type: tile
            entity: time.openquatt_silent_start_time
            name:
              type: entity
            vertical: false
          - type: tile
            entity: number.openquatt_day_max_level
            name:
              type: entity
            hide_state: false
            vertical: false
            features:
              - style: slider
                type: numeric-input
            features_position: inline
          - type: tile
            entity: number.openquatt_silent_max_level
            name:
              type: entity
            hide_state: false
            vertical: false
            features:
              - style: slider
                type: numeric-input
            features_position: inline
      - type: grid
        column_span: 2
        cards:
          - type: heading
            icon: mdi:chart-line
            heading: Performance (12h)
            heading_style: title
          - type: markdown
            content: |-
              <details>
              <summary><strong>Uitleg</strong></summary>

              Deze grafiek combineert 12-uurs trends voor:

              - `Power E`: totaal elektrisch ingangsvermogen.
              - `Power H`: totaal thermisch afgegeven vermogen.
              - `COP`: efficientieverhouding (`Power H / Power E`).

              Gebruik dit om te controleren of warmteafgifte het opgenomen vermogen volgt en of COP realistisch blijft.
              </details>
            text_only: true
          - type: custom:apexcharts-card
            header:
              show: true
              title: Power E, Power H en COP
              show_states: true
              colorize_states: true
            graph_span: 12h
            update_interval: 30s
            apex_config:
              chart:
                height: 320
                animations:
                  enabled: false
              legend:
                show: true
                position: bottom
                clusterGroupedSeries: false
              yaxis:
                - id: watts
                  min: 0
                  decimalsInFloat: 0
                  title:
                    text: Vermogen (W)
                - id: cop
                  opposite: true
                  min: 0
                  decimalsInFloat: 1
                  title:
                    text: COP
              stroke:
                width: 2
                curve: smooth
              tooltip:
                shared: true
            series:
              - entity: sensor.openquatt_total_power_input
                name: Power E
                color: '#3B82F6'
                yaxis_id: watts
                type: line
                extend_to: end
                show:
                  legend_value: false
                group_by:
                  func: avg
                  duration: 5min
                  fill: last
              - entity: sensor.openquatt_total_heat_power
                name: Power H
                color: '#F59E0B'
                yaxis_id: watts
                type: line
                extend_to: end
                show:
                  legend_value: false
                group_by:
                  func: avg
                  duration: 5min
                  fill: last
              - entity: sensor.openquatt_total_cop
                name: COP
                color: '#10B981'
                yaxis_id: cop
                type: line
                extend_to: end
                show:
                  legend_value: false
                group_by:
                  func: avg
                  duration: 5min
                  fill: last
            grid_options:
              columns: full
    cards: []
    header:
      card:
        type: markdown
        content: |-
          <img src="/local/media/openquatt/openquatt_logo.svg" width="300" />

          ## <ha-icon icon="mdi:view-dashboard"></ha-icon> Overzicht
          Snel en praktisch zicht op prestaties, status en bediening.
        text_only: true
      layout: center
      badges_position: top
      badges_wrap: wrap
    badges:
      - type: entity
        show_name: false
        show_state: true
        show_icon: false
        entity: sensor.openquatt_openquatt_version
        name:
          - type: device
          - type: entity
        state_content:
          - name
          - state
  - title: Energy
    path: energy
    icon: mdi:lightning-bolt-circle
    type: sections
    max_columns: 3
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:heat-pump
            heading: HeatPump
            heading_style: title
          - type: markdown
            content: |-
              <details>

              <summary><strong>Uitleg</strong></summary>

              HeatPump-statistieken (zonder boiler):
              - `Heat output power`: thermisch vermogen van HP1+HP2 (W)
              - `Electricity daily`: elektrische input vandaag (kWh)
              - `COP daily`: verhouding `daily heat kWh / daily electricity kWh`
              - `Heat daily`: warmteproductie vandaag (kWh)
              - `Electricity total`: cumulatieve elektrische input (kWh)
              - `Heat total`: cumulatieve warmteproductie (kWh)

              </details>
            text_only: true
          - type: entities
            title: Vandaag
            show_header_toggle: false
            entities:
              - entity: sensor.openquatt_total_heat_power
                name: Heat output power
              - entity: sensor.openquatt_electrical_energy_daily
                name: Electricity daily
              - entity: sensor.openquatt_heatpump_thermal_energy_daily
                name: Heat daily
              - entity: sensor.openquatt_heatpump_cop_daily
                name: COP daily
          - type: entities
            title: Totaal
            show_header_toggle: false
            entities:
              - entity: sensor.openquatt_electrical_energy_total
                name: Electricity total
              - entity: sensor.openquatt_heatpump_thermal_energy_total
                name: Heat total
          - type: history-graph
            title: HeatPump trends (24 uur)
            hours_to_show: 24
            refresh_interval: 60
            entities:
              - entity: sensor.openquatt_total_heat_power
                name: Heat output power
              - entity: sensor.openquatt_heatpump_cop_daily
                name: COP daily
              - entity: sensor.openquatt_heatpump_thermal_energy_daily
                name: Heat daily
            grid_options:
              columns: full
      - type: grid
        cards:
          - type: heading
            icon: mdi:water-boiler
            heading: Boiler
            heading_style: title
          - type: markdown
            content: |-
              <details>

              <summary><strong>Uitleg</strong></summary>

              Boiler-statistieken:
              - `Boiler active`: toont of de relais-aansturing actief is
              - `Heat output power`: actuele thermische boilerbijdrage (W)
              - `Heat daily`: boilerwarmte vandaag (kWh)
              - `Heat total`: cumulatieve boilerwarmte (kWh)

              </details>
            text_only: true
          - type: entities
            title: Vandaag
            show_header_toggle: false
            entities:
              - entity: sensor.openquatt_boiler_heat_power
                name: Heat output power
              - entity: sensor.openquatt_boiler_thermal_energy_daily
                name: Heat daily
              - entity: binary_sensor.openquatt_boiler_active
                name: Boiler active
          - type: entities
            title: Totaal
            show_header_toggle: false
            entities:
              - entity: sensor.openquatt_boiler_thermal_energy_total
                name: Heat total
          - type: history-graph
            title: Boiler trends (24 uur)
            hours_to_show: 24
            refresh_interval: 60
            entities:
              - entity: sensor.openquatt_boiler_heat_power
                name: Heat output power
              - entity: sensor.openquatt_boiler_thermal_energy_daily
                name: Heat daily
            grid_options:
              columns: full
      - type: grid
        cards:
          - type: heading
            icon: mdi:sigma
            heading: System
            heading_style: title
          - type: markdown
            content: |-
              <details>

              <summary><strong>Uitleg</strong></summary>

              Systeemwaarden (HeatPump + Boiler):
              - `Electricity input power`: totaal elektrisch ingangsvermogen (W)
              - `Heat output power`: totale thermische output (W)
              - `Heat daily`: systeemwarmte vandaag (kWh)
              - `Heat total`: cumulatieve systeemwarmte (kWh)

              </details>
            text_only: true
          - type: entities
            title: Vandaag
            show_header_toggle: false
            entities:
              - entity: sensor.openquatt_total_power_input
                name: Electricity input power
              - entity: sensor.openquatt_system_heat_power
                name: Heat output power
              - entity: sensor.openquatt_system_thermal_energy_daily
                name: Heat daily
          - type: entities
            title: Totaal
            show_header_toggle: false
            entities:
              - entity: sensor.openquatt_system_thermal_energy_total
                name: Heat total
          - type: history-graph
            title: System trends (24 uur)
            hours_to_show: 24
            refresh_interval: 60
            entities:
              - entity: sensor.openquatt_total_power_input
                name: Electricity input power
              - entity: sensor.openquatt_system_heat_power
                name: Heat output power
              - entity: sensor.openquatt_system_thermal_energy_daily
                name: Heat daily
            grid_options:
              columns: full
      - type: grid
        column_span: 3
        cards:
          - type: heading
            icon: mdi:chart-bar
            heading: Energy trends (7d/30d)
            heading_style: title
          - type: markdown
            content: |-
              <details>

              <summary><strong>Uitleg</strong></summary>

              Dagaggregatie voor energie:
              - Elektriciteit en warmte als dagelijkse kWh (afgeleid uit total-sensoren)
              - `COP daily` als daggemiddelde

              </details>
            text_only: true
          - type: custom:apexcharts-card
            header:
              show: true
              title: Energy trends (7 dagen)
              show_states: false
            graph_span: 7d
            update_interval: 120s
            apex_config:
              chart:
                height: 320
              legend:
                show: true
                position: top
                clusterGroupedSeries: false
              yaxis:
                - id: energy
                  min: 0
                  decimalsInFloat: 1
                  title:
                    text: kWh/day
                - id: cop
                  opposite: true
                  min: 0
                  decimalsInFloat: 2
                  title:
                    text: COP daily
              stroke:
                width: 2
                curve: smooth
              tooltip:
                shared: true
            series:
              - entity: sensor.openquatt_electrical_energy_total
                name: Electricity/day
                color: '#3B82F6'
                yaxis_id: energy
                type: column
                group_by:
                  func: delta
                  duration: 1d
              - entity: sensor.openquatt_heatpump_thermal_energy_total
                name: HeatPump heat/day
                color: '#F59E0B'
                yaxis_id: energy
                type: column
                group_by:
                  func: delta
                  duration: 1d
              - entity: sensor.openquatt_boiler_thermal_energy_total
                name: Boiler heat/day
                color: '#EF4444'
                yaxis_id: energy
                type: column
                group_by:
                  func: delta
                  duration: 1d
              - entity: sensor.openquatt_system_thermal_energy_total
                name: System heat/day
                color: '#10B981'
                yaxis_id: energy
                type: line
                group_by:
                  func: delta
                  duration: 1d
              - entity: sensor.openquatt_heatpump_cop_daily
                name: COP daily
                color: '#A855F7'
                yaxis_id: cop
                type: line
                group_by:
                  func: avg
                  duration: 1d
            grid_options:
              columns: full
          - type: custom:apexcharts-card
            header:
              show: true
              title: Energy trends (30 dagen)
              show_states: false
            graph_span: 30d
            update_interval: 300s
            apex_config:
              chart:
                height: 320
              legend:
                show: true
                position: top
                clusterGroupedSeries: false
              yaxis:
                - id: energy
                  min: 0
                  decimalsInFloat: 1
                  title:
                    text: kWh/day
                - id: cop
                  opposite: true
                  min: 0
                  decimalsInFloat: 2
                  title:
                    text: COP daily
              stroke:
                width: 2
                curve: smooth
              tooltip:
                shared: true
            series:
              - entity: sensor.openquatt_electrical_energy_total
                name: Electricity/day
                color: '#3B82F6'
                yaxis_id: energy
                type: column
                group_by:
                  func: delta
                  duration: 1d
              - entity: sensor.openquatt_heatpump_thermal_energy_total
                name: HeatPump heat/day
                color: '#F59E0B'
                yaxis_id: energy
                type: column
                group_by:
                  func: delta
                  duration: 1d
              - entity: sensor.openquatt_boiler_thermal_energy_total
                name: Boiler heat/day
                color: '#EF4444'
                yaxis_id: energy
                type: column
                group_by:
                  func: delta
                  duration: 1d
              - entity: sensor.openquatt_system_thermal_energy_total
                name: System heat/day
                color: '#10B981'
                yaxis_id: energy
                type: line
                group_by:
                  func: delta
                  duration: 1d
              - entity: sensor.openquatt_heatpump_cop_daily
                name: COP daily
                color: '#A855F7'
                yaxis_id: cop
                type: line
                group_by:
                  func: avg
                  duration: 1d
            grid_options:
              columns: full
    cards: []
    header:
      card:
        type: markdown
        content: >-
          # <ha-icon icon="mdi:lightning-bolt-circle"></ha-icon> Energy

          Energie-overzicht van HeatPump, Boiler en totaal System (dag + cumulatief).
  - title: Flow
    path: flow
    icon: mdi:waves
    type: sections
    max_columns: 3
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:waves-arrow-right
            heading: Flow status & control
            heading_style: title
          - type: markdown
            content: |-
              <details>
              <summary><strong>Uitleg</strong></summary>

              Dit blok combineert snelle statuscontrole en de belangrijkste
              flow-bediening.

              - `Flow mode` laat zien hoe de flowregeling actief is (meestal
              `AUTO` / `Flow Setpoint`).
              - `Control mode` toont in welke bedrijfsfase het systeem draait.
              - `Lowflow fault` moet in normaal bedrijf `Off` blijven.
              - `Flow mismatch` hoort `OK` te zijn; bij afwijking zijn HP1 en
              HP2 hydraulisch niet in balans.
              - `Flow setpoint`: gewenste flow waar de regeling naartoe stuurt.
              - `Manual iPWM`: directe pompaansturing voor tests; in normaal
              bedrijf uit laten.
              </details>
            text_only: true
          - type: heading
            icon: ''
            heading: Status
            heading_style: subtitle
          - type: markdown
            content: |-
              <details>
              <summary><strong>Uitleg</strong></summary>

              Flowstatus in een oogopslag:

              - `Flow mode`: actieve werking van de flowregeling.
              - `Control Mode`: actieve supervisory control state.
              - `Low Flow alarm`: beveiligingsalarm bij te lage flow.
              - `Flow (average)`: geselecteerde gemiddelde flow voor regeling/beveiliging.
              - `Flow Mismatch`: signaleert hydraulische onbalans tussen HP1 en HP2.
              </details>
            text_only: true
          - type: tile
            entity: sensor.openquatt_flow_mode
            name:
              type: entity
            show_entity_picture: false
            hide_state: false
            vertical: false
            features_position: bottom
          - type: tile
            entity: sensor.openquatt_control_mode_label
            name: Control Mode
            vertical: false
            features_position: bottom
          - type: tile
            entity: binary_sensor.openquatt_lowflow_fault_active
            name: Low Flow alarm
            vertical: false
            features_position: bottom
          - type: tile
            entity: sensor.openquatt_flow_average_selected
            name: Flow (average)
            vertical: false
            features_position: bottom
          - type: tile
            entity: binary_sensor.openquatt_flow_mismatch_hp1_vs_hp2
            name: Flow Mismatch
            vertical: false
            features_position: bottom
          - type: heading
            icon: ''
            heading: Control
            heading_style: subtitle
          - type: markdown
            content: |-
              <details>
              <summary><strong>Uitleg</strong></summary>

              Belangrijkste flow-regelinstellingen:

              - `Flow control mode`: kies automatische flowregeling of handmatige werking.
              - `Flow setpoint`: doel-flow in L/h voor automatische regeling.
              - `Manual iPWM`: directe pompaansturing voor tests (in normaal bedrijf uit laten).
              </details>
            text_only: true
          - type: tile
            entity: select.openquatt_flow_control_mode
            name:
              type: entity
            hide_state: true
            vertical: false
            features:
              - type: select-options
            features_position: inline
          - type: tile
            entity: number.openquatt_flow_setpoint
            name:
              type: entity
            hide_state: false
            vertical: false
            features:
              - style: slider
                type: numeric-input
            features_position: inline
          - type: tile
            entity: number.openquatt_manual_ipwm
            name:
              type: entity
            hide_state: false
            vertical: false
            features:
              - style: slider
                type: numeric-input
            features_position: inline
      - type: grid
        cards:
          - type: heading
            icon: mdi:chart-line
            heading: Flow trends
            heading_style: title
          - type: markdown
            content: |-
              <details>

              <summary><strong>Uitleg</strong></summary>

              - `Flowmetingen` vergelijkt actuele flow met setpoint over tijd.

              - `Pompsturing` toont iPWM-uitsturing van HP1 en HP2.

              </details>
            text_only: true
            grid_options:
              columns: full
          - type: history-graph
            title: Flowmetingen (4 uur)
            hours_to_show: 4
            refresh_interval: 30
            entities:
              - entity: sensor.openquatt_flow_average_selected
                name: Flowrate
              - entity: number.openquatt_flow_setpoint
                name: Flow setpoint
            grid_options:
              columns: full
          - type: history-graph
            title: Pompsturing (4 uur)
            hours_to_show: 4
            refresh_interval: 30
            entities:
              - entity: number.openquatt_hp1_set_pump_speed
                name: HP1 iPWM
              - entity: number.openquatt_hp2_set_pump_speed
                name: HP2 iPWM
            grid_options:
              columns: full
        column_span: 2
    cards: []
    header:
      card:
        type: markdown
        content: |-
          # <ha-icon icon="mdi:waves"></ha-icon> Flow
          Bediening, status en trends van flowregeling en pompsturing.
      layout: center
      badges_position: bottom
      badges_wrap: wrap
    badges: []
  - title: Warmtecontrol
    path: warmtecontrol
    icon: mdi:radiator
    type: sections
    max_columns: 3
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:radiator
            heading: Warmtecontrol status
            heading_style: title
          - type: markdown
            content: |-
              <details>

              <summary><strong>Uitleg</strong></summary>

              Warmtecontrol in 30 seconden:

              - Kies met `Heating mode` welke bron de warmtevraag bepaalt.
              - Vergelijk `P_req` (gevraagd vermogen) met `P_house` (modelschatting).
              - Check `Deficit`: boven `0 W` vraagt het systeem meer dan nu geleverd wordt.
              - Bekijk `Ruwe vraag` (`Demand raw`) en `Gefilterde vraag` (`Demand filtered`) om te zien hoe sterk filtering dempt.
              - `Vermogenscap vraag` (`Power cap demand`, 0..20 step) is de supervisory vraaglimiet vóór verdeling over HP1/HP2.

              Termen:

              - `P_house`: berekende warmtevraag op basis van huismodel en buitentemperatuur.
              - `P_req`: begrensde actuele warmtevraag in W na ramp-limiter.
              - `Demand raw`: ruwe vraagstap voor compressorsturing.
              - `Demand filtered`: gedempte vraagstap voor stabielere regeling.
              - `Power cap demand`: actieve supervisory limiet op demand-stappen.

              </details>
            text_only: true
          - type: heading
            icon: mdi:tune-variant
            heading: Regelinstellingen
            heading_style: subtitle
          - type: markdown
            content: |-
              <details>
              <summary><strong>Uitleg</strong></summary>

              - `Regelmodus`: kiest welke strategie de warmtevraag opbouwt (bijv. Stooklijn of Power House).
              </details>
            text_only: true
          - type: tile
            entity: select.openquatt_heating_control_mode
            name: Regelmodus
            hide_state: true
            vertical: false
            features:
              - type: select-options
            features_position: inline
          - type: heading
            icon: mdi:view-dashboard-outline
            heading: Kern KPI
            heading_style: subtitle
          - type: markdown
            content: |-
              <details>
              <summary><strong>Uitleg</strong></summary>

              Kernindicatoren voor warmtebalans:

              - `P_req`: gevraagde verwarmingspower na filtering/ramp-limiet.
              - `P_house`: gemodelleerde warmtevraag van de woning.
              - `Max capaciteit`: geschatte beschikbare warmtepompcapaciteit.
              - `Deficit`: positieve waarde betekent dat vraag boven beschikbare/geleverde warmte ligt.
              </details>
            text_only: true
          - type: grid
            square: false
            columns: 2
            cards:
              - type: tile
                entity: sensor.openquatt_power_house_p_req
                name: P_req
                vertical: false
                features_position: bottom
              - type: tile
                entity: sensor.openquatt_power_house_p_house
                name: P_house
                vertical: false
                features_position: bottom
              - type: tile
                entity: sensor.openquatt_hp_capacity_w
                name: Max capaciteit
                vertical: false
                features_position: bottom
              - type: tile
                entity: sensor.openquatt_hp_deficit_w
                name: Deficit
                vertical: false
                features_position: bottom
          - type: heading
            icon: mdi:chart-line
            heading: Vraag & limiet
            heading_style: subtitle
          - type: markdown
            content: |-
              <details>
              <summary><strong>Uitleg</strong></summary>

              Vraagvorming en begrenzing:

              - `Ruwe vraag`: directe vraagstap zonder filtering.
              - `Gefilterde vraag`: gedempte vraagstap voor stabieler gedrag.
              - `Vermogenscap vraag`: supervisory limiet op de vraag (0..20 step schaal).
              </details>
            text_only: true
          - type: grid
            square: false
            columns: 3
            cards:
              - type: tile
                entity: sensor.openquatt_demand_raw
                name: Ruwe vraag
                vertical: false
                features_position: bottom
              - type: tile
                entity: sensor.openquatt_demand_filtered
                name: Gefilterde vraag
                vertical: false
                features_position: bottom
              - type: tile
                entity: sensor.openquatt_power_cap_demand
                name: Vermogenscap vraag
                vertical: false
                features_position: bottom
          - type: heading
            icon: mdi:gauge
            heading: Capaciteit
            heading_style: subtitle
          - type: markdown
            content: |-
              <details>
              <summary><strong>Uitleg</strong></summary>

              Visuele capaciteitscheck:

              - Linker meter `Max capaciteit`: huidige geschatte maximale warmteafgifte.
              - Rechter meter `Deficit`: hoeveel warmte momenteel ontbreekt t.o.v. de vraag.

              Blijvend hoge deficit betekent dat het systeem de warmtevraag nu niet kan bijhouden.
              </details>
            text_only: true
          - type: horizontal-stack
            cards:
              - type: gauge
                entity: sensor.openquatt_hp_capacity_w
                name: Max capaciteit
                min: 0
                max: 12000
                needle: true
              - type: gauge
                entity: sensor.openquatt_hp_deficit_w
                name: Deficit
                min: 0
                max: 8000
                needle: true
                severity:
                  green: 0
                  yellow: 800
                  red: 2000
      - type: grid
        cards:
          - type: heading
            icon: mdi:chart-timeline-variant
            heading: Trends
            heading_style: title
          - type: markdown
            content: |-
              <details>

              <summary><strong>Uitleg</strong></summary>

              - `Warmtevraag` vergelijkt gevraagde (`P_req`) met geleverde warmte.
              - `HP powerinput` en `HP heat output` tonen elektrisch in versus thermisch uit.
              - `Compressorlevels en frequentie` laat setpoint versus werkelijke compressor-Hz zien.
              - `Temperatuurregeling` toont buiten-, supply- en kamertemperatuur tegen targets.

              </details>
            text_only: true
            grid_options:
              columns: full
          - type: history-graph
            title: Warmtevraag (24 uur)
            hours_to_show: 24
            refresh_interval: 30
            entities:
              - entity: sensor.openquatt_power_house_p_req
                name: Requested Power
              - entity: sensor.openquatt_total_heat_power
                name: Actual Power
            grid_options:
              columns: full
          - type: history-graph
            title: HP powerinput (24 uur)
            hours_to_show: 24
            refresh_interval: 30
            entities:
              - entity: sensor.openquatt_hp1_power_input
                name: HP1 powerinput
              - entity: sensor.openquatt_hp2_power_input
                name: HP2 powerinput
            grid_options:
              columns: full
          - type: history-graph
            title: HP heat output (24 uur)
            hours_to_show: 24
            refresh_interval: 30
            entities:
              - entity: sensor.openquatt_hp1_heat_power
                name: HP1 heating power
              - entity: sensor.openquatt_hp2_heat_power
                name: HP2 heating power
            grid_options:
              columns: full
          - type: history-graph
            title: Compressorlevels en frequentie (24 uur)
            hours_to_show: 24
            refresh_interval: 30
            entities:
              - entity: sensor.openquatt_hp1_compressor_level
                name: HP1 level
              - entity: sensor.openquatt_hp2_compressor_level
                name: HP2 level
              - entity: sensor.openquatt_hp1_compressor_frequency
                name: HP1 Hz
              - entity: sensor.openquatt_hp2_compressor_frequency
                name: HP2 Hz
            grid_options:
              columns: full
          - type: history-graph
            title: Temperatuurregeling (24 uur)
            hours_to_show: 24
            refresh_interval: 30
            entities:
              - entity: sensor.openquatt_outside_temperature_selected
                name: Buiten
              - entity: sensor.openquatt_water_supply_temp_selected
                name: Supply systeem
              - entity: sensor.openquatt_heating_curve_supply_target
                name: Supply target
              - entity: sensor.openquatt_room_temperature_selected
                name: Kamer temp
              - entity: sensor.openquatt_room_setpoint_selected
                name: Kamer setpoint
            grid_options:
              columns: full
        column_span: 2
    cards: []
    header:
      card:
        type: markdown
        content: |-
          # <ha-icon icon="mdi:radiator"></ha-icon> Warmtecontrol
          Warmtevraag, heat allocation en compressorbelasting.
  - title: HPs
    path: HPs
    icon: mdi:heat-pump-outline
    type: sections
    sections:
      - type: grid
        cards:
          - square: false
            type: grid
            columns: 1
            cards:
              - type: picture-elements
                title: Quatt HP1
                image: /local/media/quatt_dashboard/Quatt.png
                elements:
                  - type: image
                    style:
                      left: 0%
                      top: 0%
                      transform: translate(0,0)
                    entity: binary_sensor.openquatt_hp1_4_way_valve
                    state_image:
                      'on': /local/media/quatt_dashboard/Cool.png
                      'off': /local/media/quatt_dashboard/Heat.png
                      unknown: /local/media/quatt_dashboard/Heat.png
                      unavailable: /local/media/quatt_dashboard/Heat.png
                    tap_action:
                      action: none
                    hold_action:
                      action: none
                  - type: state-label
                    entity: sensor.openquatt_hp1_outside_temperature
                    style:
                      top: 3%
                      left: 8%
                      font-weight: bold
                      color: black
                      font-size: 0.75em
                      transform: none
                    prefix: 'Outside: '
                  - type: state-badge
                    entity: sensor.openquatt_hp1_gas_discharge_temperature
                    style:
                      top: 22%
                      left: 58%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp1_inner_coil_temperature
                    style:
                      top: 70%
                      left: 60%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp1_eev_steps
                    style:
                      top: 70%
                      left: 42%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp1_gas_return_temperature
                    style:
                      top: 22%
                      left: 26%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp1_evaporating_temperature
                    style:
                      top: 70%
                      left: 25%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp1_evaporator_coil_temperature
                    style:
                      top: 58%
                      left: 6%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp1_condenser_pressure
                    style:
                      top: 11%
                      left: 55%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp1_evaporator_pressure
                    style:
                      top: 11%
                      left: 30%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp1_fan_speed
                    style:
                      top: 53%
                      left: 25%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp1_compressor_frequency
                    style:
                      top: 18%
                      left: 40%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp1_water_out_temperature
                    style:
                      top: 43%
                      left: 92%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp1_water_in_temperature
                    style:
                      top: 63%
                      left: 92%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp1_flow
                    style:
                      top: 76%
                      left: 81%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-label
                    entity: sensor.openquatt_hp1_working_mode
                    style:
                      top: 8%
                      left: 8%
                      font-weight: bold
                      color: white
                      font-size: 0.75em
                      transform: none
                    prefix: 'Mode: '
                  - type: state-label
                    entity: sensor.openquatt_hp1_power_input
                    style:
                      top: 11%
                      left: 8%
                      font-weight: bold
                      color: white
                      font-size: 0.75em
                      transform: none
                    prefix: 'Power In: '
                  - type: state-label
                    entity: sensor.openquatt_hp1_heat_power
                    style:
                      top: 14%
                      left: 8%
                      font-weight: bold
                      color: white
                      font-size: 0.75em
                      transform: none
                    prefix: 'Power Out: '
                  - type: state-label
                    entity: sensor.openquatt_hp1_cop
                    style:
                      top: 17%
                      left: 8%
                      font-weight: bold
                      color: white
                      font-size: 0.75em
                      transform: none
                    prefix: 'COP: '
            grid_options:
              columns: 12
              rows: auto
          - square: false
            type: grid
            columns: 1
            cards:
              - type: entities
                title: HP1 kernwaarden
                show_header_toggle: false
                entities:
                  - entity: sensor.openquatt_hp1_working_mode
                    name: Work mode
                  - entity: sensor.openquatt_hp1_active_failures_list
                    name: Active failures list
                  - entity: sensor.openquatt_hp1_power_input
                    name: Power input
                  - entity: sensor.openquatt_hp1_heat_power
                    name: Heat power
                  - entity: sensor.openquatt_hp1_cop
                    name: COP
                  - entity: sensor.openquatt_hp1_flow
                    name: Flow
                  - entity: sensor.openquatt_hp1_water_in_temperature
                    name: Water in temp
                  - entity: sensor.openquatt_hp1_water_out_temperature
                    name: Water out temp
                  - entity: binary_sensor.openquatt_hp1_defrost
                    name: Defrost
                  - entity: binary_sensor.openquatt_hp1_4_way_valve
                    name: 4-way valve
            grid_options:
              columns: 12
              rows: auto
        column_span: 1
      - type: grid
        cards:
          - square: false
            type: grid
            columns: 1
            cards:
              - type: picture-elements
                title: Quatt HP2
                image: /local/media/quatt_dashboard/Quatt.png
                elements:
                  - type: image
                    style:
                      left: 0%
                      top: 0%
                      transform: translate(0,0)
                    entity: binary_sensor.openquatt_hp2_4_way_valve
                    state_image:
                      'on': /local/media/quatt_dashboard/Cool.png
                      'off': /local/media/quatt_dashboard/Heat.png
                      unknown: /local/media/quatt_dashboard/Heat.png
                      unavailable: /local/media/quatt_dashboard/Heat.png
                    tap_action:
                      action: none
                    hold_action:
                      action: none
                  - type: state-label
                    entity: sensor.openquatt_hp2_outside_temperature
                    style:
                      top: 3%
                      left: 8%
                      font-weight: bold
                      color: black
                      font-size: 0.75em
                      transform: none
                    prefix: 'Outside: '
                  - type: state-badge
                    entity: sensor.openquatt_hp2_gas_discharge_temperature
                    style:
                      top: 22%
                      left: 58%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp2_inner_coil_temperature
                    style:
                      top: 70%
                      left: 60%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp2_eev_steps
                    style:
                      top: 70%
                      left: 42%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp2_gas_return_temperature
                    style:
                      top: 22%
                      left: 26%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp2_evaporating_temperature
                    style:
                      top: 70%
                      left: 25%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp2_evaporator_coil_temperature
                    style:
                      top: 58%
                      left: 6%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp2_condenser_pressure
                    style:
                      top: 11%
                      left: 55%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp2_evaporator_pressure
                    style:
                      top: 11%
                      left: 30%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp2_fan_speed
                    style:
                      top: 53%
                      left: 25%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp2_compressor_frequency
                    style:
                      top: 18%
                      left: 40%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp2_water_out_temperature
                    style:
                      top: 43%
                      left: 92%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp2_water_in_temperature
                    style:
                      top: 63%
                      left: 92%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-badge
                    entity: sensor.openquatt_hp2_flow
                    style:
                      top: 76%
                      left: 81%
                      font-weight: bold
                      color: rgba(0,0,0,0)
                      transform: none
                      font-size: 0.65em
                  - type: state-label
                    entity: sensor.openquatt_hp2_working_mode
                    style:
                      top: 8%
                      left: 8%
                      font-weight: bold
                      color: white
                      font-size: 0.75em
                      transform: none
                    prefix: 'Mode: '
                  - type: state-label
                    entity: sensor.openquatt_hp2_power_input
                    style:
                      top: 11%
                      left: 8%
                      font-weight: bold
                      color: white
                      font-size: 0.75em
                      transform: none
                    prefix: 'Power In: '
                  - type: state-label
                    entity: sensor.openquatt_hp2_heat_power
                    style:
                      top: 14%
                      left: 8%
                      font-weight: bold
                      color: white
                      font-size: 0.75em
                      transform: none
                    prefix: 'Power Out: '
                  - type: state-label
                    entity: sensor.openquatt_hp2_cop
                    style:
                      top: 17%
                      left: 8%
                      font-weight: bold
                      color: white
                      font-size: 0.75em
                      transform: none
                    prefix: 'COP: '
            grid_options:
              columns: 12
              rows: auto
          - square: false
            type: grid
            columns: 1
            cards:
              - type: entities
                title: HP2 kernwaarden
                show_header_toggle: false
                entities:
                  - entity: sensor.openquatt_hp2_working_mode
                    name: Work mode
                  - entity: sensor.openquatt_hp2_active_failures_list
                    name: Active failures list
                  - entity: sensor.openquatt_hp2_power_input
                    name: Power input
                  - entity: sensor.openquatt_hp2_heat_power
                    name: Heat power
                  - entity: sensor.openquatt_hp2_cop
                    name: COP
                  - entity: sensor.openquatt_hp2_flow
                    name: Flow
                  - entity: sensor.openquatt_hp2_water_in_temperature
                    name: Water in temp
                  - entity: sensor.openquatt_hp2_water_out_temperature
                    name: Water out temp
                  - entity: binary_sensor.openquatt_hp2_defrost
                    name: Defrost
                  - entity: binary_sensor.openquatt_hp2_4_way_valve
                    name: 4-way valve
            grid_options:
              columns: 12
              rows: auto
        column_span: 1
    max_columns: 4
    header:
      card:
        type: markdown
        content: >-
          # <ha-icon icon="mdi:heat-pump-outline"></ha-icon> Overview HP1&HP2

          Deze tab toont per HP een technische momentopname van
          koudemiddel/waterzijde. Gebruik dit vooral voor diagnose en
          vergelijking tussen HP1 en HP2.

          Voor instellingen: gebruik `Flow`, `Warmtecontrol` en `Advanced
          settings`.
  - title: Sensorconfiguratie
    path: sensor-configuration
    icon: mdi:source-branch
    type: sections
    max_columns: 3
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:source-branch
            heading: Sensorselectie
            heading_style: title
          - type: markdown
            content: |-
              <details>
              <summary><strong>Uitleg</strong></summary>

              Kies per signaal de bron die OpenQuatt gebruikt.
              De `Selected` waarde hoort de gekozen bron direct te volgen.

              Gebruik dit blok voor:
              - bronkeuze tijdens tuning
              - snelle vergelijking tussen CIC, lokaal en HA input
              - validatie van de effectieve regelinput

              </details>
            text_only: true
          - type: vertical-stack
            cards:
              - type: heading
                icon: mdi:home-thermometer
                heading: Ruimtetemperatuur bronnen
                heading_style: subtitle
                grid_options:
                  columns: 12
                  rows: 1
              - type: entities
                show_header_toggle: false
                entities:
                  - entity: select.openquatt_room_temperature_source
                    name: Ruimtetemperatuur bron
                  - entity: sensor.openquatt_room_temperature_selected
                    name: Selected room temp
                  - entity: sensor.openquatt_cic_ot_room_temperature
                    name: Room temp (CIC OT)
                  - entity: sensor.openquatt_ha_thermostat_room_temperature
                    name: Room temp (HA input)
          - type: vertical-stack
            cards:
              - type: heading
                icon: mdi:water-thermometer
                heading: Water supply bronnen
                heading_style: subtitle
                grid_options:
                  columns: 12
                  rows: 1
              - type: entities
                show_header_toggle: false
                entities:
                  - entity: select.openquatt_water_supply_source
                    name: Water supply bron
                  - entity: sensor.openquatt_water_supply_temp_selected
                    name: Selected water supply temp
                  - entity: sensor.openquatt_water_supply_temp
                    name: Water supply temp (ESP)
                  - entity: sensor.openquatt_cic_water_supply_temp
                    name: Water supply temp (CIC)
          - type: vertical-stack
            cards:
              - type: heading
                icon: mdi:waves
                heading: Flow bronnen
                heading_style: subtitle
                grid_options:
                  columns: 12
                  rows: 1
              - type: entities
                show_header_toggle: false
                entities:
                  - entity: select.openquatt_flow_source
                    name: Flow bron
                  - entity: sensor.openquatt_flow_average_selected
                    name: Selected flow rate
                  - entity: sensor.openquatt_flow_average_local
                    name: Flow rate (Outdoor unit)
                  - entity: sensor.openquatt_cic_flowrate_filtered
                    name: Flow rate (CIC)
          - type: vertical-stack
            cards:
              - type: heading
                icon: mdi:thermometer
                heading: Buiten temperatuur bronnen
                heading_style: subtitle
                grid_options:
                  columns: 12
                  rows: 1
              - type: entities
                show_header_toggle: false
                entities:
                  - entity: select.openquatt_outside_temperature_source
                    name: Buitentemperatuur bron
                  - entity: sensor.openquatt_outside_temperature_selected
                    name: Selected buiten temp
                  - entity: sensor.openquatt_outside_temperature_local_aggregated
                    name: Buiten temp (Outdoor unit)
                  - entity: sensor.openquatt_ha_outside_temperature
                    name: Buiten temp (HA input)
          - type: vertical-stack
            cards:
              - type: heading
                icon: mdi:thermostat
                heading: Kamer setpoint bronnen
                heading_style: subtitle
                grid_options:
                  columns: 12
                  rows: 1
              - type: entities
                show_header_toggle: false
                entities:
                  - entity: select.openquatt_room_setpoint_source
                    name: Kamer setpoint bron
                  - entity: sensor.openquatt_room_setpoint_selected
                    name: Selected room setpoint
                  - entity: sensor.openquatt_cic_ot_room_setpoint
                    name: Room setpoint (CIC OT)
                  - entity: sensor.openquatt_ha_thermostat_setpoint
                    name: Room setpoint (HA input)
        column_span: 3
      - type: grid
        cards:
          - type: heading
            icon: mdi:home-assistant
            heading: Home Assistant input configuration
            heading_style: title
          - type: vertical-stack
            cards:
              - type: heading
                icon: mdi:form-textbox
                heading: Dynamische bronselectors
                heading_style: subtitle
              - type: markdown
                content: |-
                  <details>
                  <summary><strong>Uitleg</strong></summary>

                  Vul hier de entity IDs in van de bronnen die de OpenQuatt HA
                  proxy-sensoren moeten voeden.

                  Voorbeelden:
                  - `sensor.outdoor_temperature`
                  - `sensor.thermostat_setpoint`
                  - `sensor.thermostat_room_temperature`
                  - `climate.woonkamer | current_temperature`

                  Optioneel attribuutformaat:
                  - `entity_id|attribute_name`
                  Spaties rond `|` worden genegeerd.

                  Is een bron ongeldig, dan wordt de proxywaarde `Unavailable`.
                  </details>
                text_only: true
              - type: entities
                show_header_toggle: false
                entities:
                  - entity: input_text.openquatt_source_outdoor_temperature
                    name: Bronentity buitentemperatuur
                  - entity: input_text.openquatt_source_room_setpoint
                    name: Bronentity setpoint
                  - entity: input_text.openquatt_source_room_temperature
                    name: Bronentity ruimtetemperatuur
          - type: vertical-stack
            cards:
              - type: heading
                icon: mdi:database-arrow-right
                heading: HA proxywaarden en validiteit
                heading_style: subtitle
              - type: markdown
                content: |-
                  <details>
                  <summary><strong>Uitleg</strong></summary>

                  Dit zijn de stabiele HA proxy-entities die als contract naar
                  OpenQuatt dienen.

                  De status `Valid` hoort voor alle drie signalen op `on` te staan.
                  Als `Valid` op `off` staat, is de huidige bron niet numeriek.
                  Dan wordt de proxywaarde `Unavailable` totdat de bron weer geldig
                  is.
                  </details>
                text_only: true
              - type: entities
                show_header_toggle: false
                entities:
                  - entity: sensor.openquatt_ext_outdoor_temperature
                    name: Proxy buitentemperatuur
                  - entity: binary_sensor.openquatt_ext_outdoor_temperature_valid
                    name: Buitentemperatuur bron valid
                  - entity: sensor.openquatt_ext_room_setpoint
                    name: Proxy kamer setpoint
                  - entity: binary_sensor.openquatt_ext_room_setpoint_valid
                    name: Setpoint bron valid
                  - entity: sensor.openquatt_ext_room_temperature
                    name: Proxy ruimtetemperatuur
                  - entity: binary_sensor.openquatt_ext_room_temperature_valid
                    name: Ruimtetemperatuur bron valid
          - type: vertical-stack
            cards:
              - type: heading
                icon: mdi:chip
                heading: OpenQuatt HA-invoerwaarden
                heading_style: subtitle
              - type: markdown
                content: |-
                  <details>
                  <summary><strong>Uitleg</strong></summary>

                  Dit zijn de drie HA-invoerwaarden zoals OpenQuatt ze ontvangt.
                  Deze horen de proxywaarden uit het middelste blok te volgen.

                  Blijft een waarde op `Unknown`, controleer dan eerst of de
                  bijbehorende `... bron valid` op `on` staat.

                  </details>
                text_only: true
              - type: entities
                show_header_toggle: false
                entities:
                  - entity: sensor.openquatt_ha_outside_temperature
                    name: HA - Outside Temperature
                  - entity: sensor.openquatt_ha_thermostat_setpoint
                    name: HA - Thermostat Setpoint
                  - entity: sensor.openquatt_ha_thermostat_room_temperature
                    name: HA - Thermostat Room Temperature
        column_span: 3
      - type: grid
        cards:
          - type: heading
            icon: mdi:cloud-check
            heading_style: title
            heading: Quatt CiC configuration
          - type: markdown
            content: |-
              <details>
              <summary><strong>Uitleg</strong></summary>

              Dit blok toont de status van de CiC-feed.
              Als de feed niet OK is of data stale wordt, kunnen CIC-bronnen
              onbruikbaar worden voor de geselecteerde signalen.

              Controleer bij afwijkingen:
              - `JSON feed OK`
              - `Data stale`
              - `Last success age`

              </details>
            text_only: true
          - type: entities
            show_header_toggle: false
            entities:
              - entity: switch.openquatt_cic_enable_polling
                name: Enable polling
              - entity: binary_sensor.openquatt_cic_json_feed_ok
                name: JSON feed OK
              - entity: binary_sensor.openquatt_cic_data_stale
                name: Data stale
              - entity: sensor.openquatt_cic_last_success_age
                name: Last success age
              - entity: sensor.openquatt_cic_polling_interval
                name: Polling interval
              - entity: text.openquatt_cic_feed_url
                name: CIC feed URL
    cards: []
    header:
      card:
        type: markdown
        content: |-
          # <ha-icon icon="mdi:source-branch"></ha-icon> Sensorconfiguratie

          Configureer bronkeuze en bronkoppeling, en verifieer daarna per signaal
          de geselecteerde waarde en bronstatus.
    top_margin: false
    dense_section_placement: false
  - title: Advanced settings
    path: advanced-settings
    icon: mdi:tune-vertical
    type: sections
    max_columns: 3
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:window-maximize
            heading: Systeemlimieten en vensters
            heading_style: title
          - type: markdown
            content: >-
              <details>

              <summary><strong>Uitleg parameters</strong></summary>


              - **Day max level / Silent max level** begrenzen het maximale
              compressorlevel in normale of stille uren.

              - **Silent start/end time** definieert het tijdvenster waarin de
              silent-begrenzing actief is.

              - **CM3 deficit ON/OFF thresholds** bepalen wanneer boiler-assist
              mag inschakelen/uitschakelen.

              - Houd ON duidelijk hoger dan OFF om schakelen rond de grens te
              beperken.

              - Bij te agressief gedrag: ON verhogen of OFF verlagen.


              </details>
            text_only: true
          - type: entities
            show_header_toggle: false
            entities:
              - entity: number.openquatt_day_max_level
                name: Day max level
              - entity: number.openquatt_silent_max_level
                name: Silent max level
              - entity: time.openquatt_silent_start_time
                name: Silent start time
              - entity: time.openquatt_silent_end_time
                name: Silent end time
              - entity: number.openquatt_cm3_deficit_on_threshold
                name: CM3 deficit ON threshold
              - entity: number.openquatt_cm3_deficit_off_threshold
                name: CM3 deficit OFF threshold
      - type: grid
        cards:
          - type: heading
            icon: mdi:home-thermometer-outline
            heading: House model (Power House)
            heading_style: title
          - type: markdown
            content: >-
              <details>

              <summary><strong>Uitleg parameters</strong></summary>


              - **House cold temp** en **Rated maximum house power (Pr)**
              bepalen samen de schaal van de warmtevraag bij koude condities.

              - **Maximum heating outdoor temperature** is het punt waar
              modelmatig de warmtevraag naar ~0 gaat.

              - **Power House Kp** bepaalt hoe sterk kamertemperatuurfout naar
              warmtevraag (W) wordt vertaald.

              - **Deadband** voorkomt onrust bij kleine afwijkingen.

              - **Comfort onder/boven setpoint** definieert een asymmetrische
              comfortzone rond de kamersetpoint waarin de room-correctie neutraal
              blijft. Zo kan elke gebruiker eigen onder-/overshoot instellen.

              - **Comfort bias base/max** verschuift de effectieve kamertarget
              omhoog (warmte-voorkeur) en begrenst maximale adaptieve overshoot.
              De bovenste correctierand is gemaximeerd op `setpoint + bias max`.

              - **Comfort bias up/down** en **room error avg tau** bepalen hoe
              snel deze warm-bias zich aanpast over de tijd.

              - **Ramp up/down** begrenzen stijg-/daalsnelheid van gevraagde
              warmte.

              </details>
            text_only: true
          - type: entities
            show_header_toggle: false
            entities:
              - entity: number.openquatt_house_cold_temp
                name: House cold temp
              - entity: number.openquatt_maximum_heating_outdoor_temperature
                name: Maximum heating outdoor temperature (P=0 temp)
              - entity: number.openquatt_rated_maximum_house_power
                name: Rated maximum house power (Pr)
              - entity: number.openquatt_power_house_kp_w_k
                name: Power House Kp (W/K)
              - entity: number.openquatt_power_house_deadband
                name: Power House deadband
              - entity: number.openquatt_power_house_comfort_below_setpoint
                name: Power House comfort below setpoint
              - entity: number.openquatt_power_house_comfort_above_setpoint
                name: Power House comfort above setpoint
              - entity: number.openquatt_power_house_comfort_bias_base
                name: Power House comfort bias base
              - entity: number.openquatt_power_house_comfort_bias_max
                name: Power House comfort bias max
              - entity: number.openquatt_power_house_comfort_bias_up
                name: Power House comfort bias up
              - entity: number.openquatt_power_house_comfort_bias_down
                name: Power House comfort bias down
              - entity: number.openquatt_power_house_room_error_avg_tau
                name: Power House room error avg tau
              - entity: number.openquatt_power_house_ramp_up
                name: Power House ramp up
              - entity: number.openquatt_power_house_ramp_down
                name: Power House ramp down
      - type: grid
        cards:
          - type: heading
            icon: mdi:chart-bell-curve
            heading: Stooklijn en PID
            heading_style: title
          - type: markdown
            content: >-
              <details>

              <summary><strong>Uitleg parameters</strong></summary>


              - De **curve Tsupply**-punten vormen de stooklijn: gewenste
              aanvoertemperatuur bij verschillende buitentemperaturen.

              - Pas eerst de curvepunten aan voor het juiste basiscomfort,
              daarna pas PID finetunen.

              - **Fallback Tsupply** wordt gebruikt als buitentemperatuur
              tijdelijk ontbreekt.

              - **PID Kp/Ki/Kd** bepaalt de correctie op de
              systeem-aanvoertemperatuur:
                - Kp te hoog: snelle maar nerveuze reactie.
                - Ki te hoog: traag pendelen/overshoot.
                - Kd meestal laag houden in trage hydraulische systemen.

              </details>
            text_only: true
          - type: entities
            show_header_toggle: false
            entities:
              - entity: number.openquatt_curve_tsupply_20degc
                name: Curve Tsupply @ -20C
              - entity: number.openquatt_curve_tsupply_10degc
                name: Curve Tsupply @ -10C
              - entity: number.openquatt_curve_tsupply_0degc
                name: Curve Tsupply @ 0C
              - entity: number.openquatt_curve_tsupply_5degc
                name: Curve Tsupply @ 5C
              - entity: number.openquatt_curve_tsupply_10degc_2
                name: Curve Tsupply @ 10C
              - entity: number.openquatt_curve_tsupply_15degc
                name: Curve Tsupply @ 15C
              - entity: number.openquatt_curve_fallback_tsupply_no_outside_temp
                name: Curve fallback Tsupply
              - entity: number.openquatt_heating_curve_pid_kp
                name: Heating Curve PID Kp
              - entity: number.openquatt_heating_curve_pid_ki
                name: Heating Curve PID Ki
              - entity: number.openquatt_heating_curve_pid_kd
                name: Heating Curve PID Kd
          - type: custom:apexcharts-card
            header:
              show: true
              title: Stooklijn (instelpunten)
              show_states: false
            update_interval: 10s
            apex_config:
              chart:
                height: 320px
              xaxis:
                type: numeric
                forceNiceScale: true
                min: -20
                max: 15
                title:
                  text: Buiten temperatuur (°C)
              yaxis:
                forceNiceScale: true
                title:
                  text: Tsupply (°C)
              tooltip:
                x:
                  formatter: |
                    function (value) {
                      return `${Number(value)} °C`;
                    }
              stroke:
                curve: straight
                width: 3
              markers:
                size: 5
            series:
              - entity: number.openquatt_curve_tsupply_20degc
                name: Curve setpoints
                type: line
                data_generator: |
                  const getNum = (eid) => {
                    const s = hass.states[eid];
                    if (!s) return null;
                    const v = parseFloat(s.state);
                    return Number.isFinite(v) ? v : null;
                  };

                  const pts = [
                    { x: "-20", y: getNum("number.openquatt_curve_tsupply_20degc") },
                    { x: "-10", y: getNum("number.openquatt_curve_tsupply_10degc") },
                    { x: "0",   y: getNum("number.openquatt_curve_tsupply_0degc") },
                    { x: "5",   y: getNum("number.openquatt_curve_tsupply_5degc") },
                    { x: "10",  y: getNum("number.openquatt_curve_tsupply_10degc_2") },
                    { x: "15",  y: getNum("number.openquatt_curve_tsupply_15degc") }
                  ];

                  return pts.filter((p) => p.y !== null);
            grid_options:
              columns: full
      - type: grid
        cards:
          - type: heading
            icon: mdi:heat-wave
            heading: Heat allocation
            heading_style: title
          - type: markdown
            content: >-
              <details>

              <summary><strong>Uitleg parameters</strong></summary>


              - **Minimum runtime** voorkomt kortcyclen en overmatig
              start/stop-gedrag.

              - **Demand filter ramp up** bepaalt met hoeveel demand-stappen per
              minuut `Demand filtered` maximaal mag stijgen richting `Demand raw`.

              - **Single HP assist ON/OFF deficit** bepaalt bij welke thermische
              tekort-waarde extra HP-assist wordt geactiveerd of weer
              losgelaten.

              - **ON/OFF hold** voegt tijdhysterese toe om op en neer schakelen
              te dempen.

              - Lager ON of kortere ON-hold = sneller extra capaciteit.

              - Hoger OFF of langere OFF-hold = langer dual-HP actief.


              </details>
            text_only: true
          - type: entities
            show_header_toggle: false
            entities:
              - entity: number.openquatt_minimum_runtime
                name: Minimum runtime
              - entity: number.openquatt_demand_filter_ramp_up
                name: Demand filter ramp up
              - entity: number.openquatt_single_hp_assist_on_deficit
                name: Single HP assist ON deficit
              - entity: number.openquatt_single_hp_assist_off_deficit
                name: Single HP assist OFF deficit
              - entity: number.openquatt_single_hp_assist_on_hold
                name: Single HP assist ON hold
              - entity: number.openquatt_single_hp_assist_off_hold
                name: Single HP assist OFF hold
      - type: grid
        cards:
          - type: heading
            icon: mdi:speedometer-medium
            heading: Allowed compressor levels
            heading_style: title
          - type: markdown
            content: >-
              <details>

              <summary><strong>Uitleg parameters</strong></summary>


              - Deze switches begrenzen welke compressorlevels per HP gebruikt
              mogen worden.

              - `Aan` betekent: level mag door de verdelingslogica gekozen
              worden.

              - `Uit` betekent: level wordt overgeslagen.

              - Meestal laat je alle levels aan; schakel alleen uit voor testen,
              geluid of specifieke beperkingen.

              - Houd per HP minimaal een aaneengesloten reeks levels actief om
              onnodige sprongen te voorkomen.


              </details>
            text_only: true
            grid_options:
              columns: full
              rows: auto
          - type: entities
            title: HP1 allowed levels
            show_header_toggle: false
            entities:
              - entity: switch.openquatt_hp1_allowed_level_1_h_30hz_c_30hz
                name: L1 (H30/C30)
              - entity: switch.openquatt_hp1_allowed_level_2_h_39hz_c_36hz
                name: L2 (H39/C36)
              - entity: switch.openquatt_hp1_allowed_level_3_h_49hz_c_42hz
                name: L3 (H49/C42)
              - entity: switch.openquatt_hp1_allowed_level_4_h_55hz_c_47hz
                name: L4 (H55/C47)
              - entity: switch.openquatt_hp1_allowed_level_5_h_61hz_c_52hz
                name: L5 (H61/C52)
              - entity: switch.openquatt_hp1_allowed_level_6_h_67hz_c_56hz
                name: L6 (H67/C56)
              - entity: switch.openquatt_hp1_allowed_level_7_h_72hz_c_61hz
                name: L7 (H72/C61)
              - entity: switch.openquatt_hp1_allowed_level_8_h_79hz_c_66hz
                name: L8 (H79/C66)
              - entity: switch.openquatt_hp1_allowed_level_9_h_85hz_c_71hz
                name: L9 (H85/C71)
              - entity: switch.openquatt_hp1_allowed_level_10_h_90hz_c_74hz
                name: L10 (H90/C74)
          - type: entities
            title: HP2 allowed levels
            show_header_toggle: false
            entities:
              - entity: switch.openquatt_hp2_allowed_level_1_h_30hz_c_30hz
                name: L1 (H30/C30)
              - entity: switch.openquatt_hp2_allowed_level_2_h_39hz_c_36hz
                name: L2 (H39/C36)
              - entity: switch.openquatt_hp2_allowed_level_3_h_49hz_c_42hz
                name: L3 (H49/C42)
              - entity: switch.openquatt_hp2_allowed_level_4_h_55hz_c_47hz
                name: L4 (H55/C47)
              - entity: switch.openquatt_hp2_allowed_level_5_h_61hz_c_52hz
                name: L5 (H61/C52)
              - entity: switch.openquatt_hp2_allowed_level_6_h_67hz_c_56hz
                name: L6 (H67/C56)
              - entity: switch.openquatt_hp2_allowed_level_7_h_72hz_c_61hz
                name: L7 (H72/C61)
              - entity: switch.openquatt_hp2_allowed_level_8_h_79hz_c_66hz
                name: L8 (H79/C66)
              - entity: switch.openquatt_hp2_allowed_level_9_h_85hz_c_71hz
                name: L9 (H85/C71)
              - entity: switch.openquatt_hp2_allowed_level_10_h_90hz_c_74hz
                name: L10 (H90/C74)
        column_span: 2
      - type: grid
        cards:
          - type: heading
            icon: mdi:tune-variant
            heading: Flow tuning
            heading_style: title
          - type: markdown
            content: >-
              <details>

              <summary><strong>Uitleg parameters</strong></summary>


              - **Auto start iPWM** bepaalt de initiële pompaansturing bij
              flowregeling.

              - **CM98 iPWM** is de circulatiesetting voor anti-freeze context.

              - **Flow PI Kp/Ki** bepaalt de dynamiek van flowregeling; wijzig
              in kleine stappen.

              - **Sticky pump iPWM** is vooral service/onderhoud en wordt zelden
              aangepast.


              </details>
            text_only: true
          - type: entities
            show_header_toggle: false
            entities:
              - entity: number.openquatt_flow_auto_start_ipwm
                name: Auto start iPWM
              - entity: number.openquatt_frost_circulation_ipwm
                name: CM98 iPWM
              - entity: number.openquatt_flow_pi_kp
                name: Flow PI Kp
              - entity: number.openquatt_flow_pi_ki
                name: Flow PI Ki
              - entity: number.openquatt_sticky_pump_ipwm
                name: Sticky pump iPWM
      - type: grid
        cards:
          - type: heading
            icon: mdi:tools
            heading: Flow autotune
            heading_style: title
          - type: markdown
            content: >-
              <details>

              <summary><strong>Uitleg parameters</strong></summary>


              - **Flow autotune** starten bij stabiele installatie en zonder
              actieve fouten.

              - Eerst `u_step` en `max duration` bepalen, daarna pas autotune
              starten.

              - `Apply autotune Kp/Ki` alleen toepassen als de voorgestelde
              waarden logisch zijn.


              </details>
            text_only: true
          - type: entities
            show_header_toggle: false
            entities:
              - entity: switch.openquatt_flow_autotune_enable
                name: Flow autotune enable
              - entity: button.openquatt_flow_autotune_start
                name: Flow autotune start
              - entity: button.openquatt_flow_autotune_abort
                name: Flow autotune abort
              - entity: button.openquatt_apply_flow_autotune_kp_ki
                name: Apply autotune Kp/Ki
              - entity: number.openquatt_flow_autotune_u_step_ipwm
                name: Autotune u_step (iPWM)
              - entity: number.openquatt_flow_autotune_max_duration_s
                name: Autotune max duration
              - entity: number.openquatt_flow_autotune_kp_suggested
                name: Autotune Kp suggested
              - entity: number.openquatt_flow_autotune_ki_suggested
                name: Autotune Ki suggested
              - entity: sensor.openquatt_flow_autotune_status
                name: Autotune status
    header:
      card:
        type: markdown
        content: >-
          # <ha-icon icon="mdi:tune-vertical"></ha-icon> Advanced settings

          Geavanceerde tuning van limieten, huismodel, stooklijn,
          heat-allocation en flow.
    cards: []
  - title: Debug & Testing
    path: debug-testing
    icon: mdi:flask-outline
    type: sections
    max_columns: 2
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:tools
            heading: Runtime / draaiuren
            heading_style: title
          - type: markdown
            content: >-
              <details>

              <summary><strong>Uitleg parameters</strong></summary>


              - **Reset runtime counters**. Let op: het kan maximaal 1 minuut
              duren voordat je effect ziet.

              - **HP1/HP2 Runtime counters** tonen de actuele teller waarop de
              runtime-balans wordt gebaseerd.

              - **Runtime lead HP** toont welke unit momenteel lead is op basis
              van de laagste runtime.


              </details>
            text_only: true
          - type: entities
            show_header_toggle: false
            entities:
              - entity: button.openquatt_reset_runtime_counters_hp1_hp2
                name: Reset runtime counters
              - entity: sensor.openquatt_hp1_runtime_hours
                name: HP1 Runtime
              - entity: sensor.openquatt_hp2_runtime_hours
                name: HP2 Runtime
              - entity: sensor.openquatt_runtime_lead_hp
                name: Runtime lead HP
      - type: grid
        cards:
          - type: heading
            icon: mdi:flask-outline
            heading: Handmatige Modbus testlezer
            heading_style: title
          - type: markdown
            content: |-
              <details>
              <summary><strong>Uitleg</strong></summary>

              Eenmalige handmatige register-read voor debug/test:

              - Kies eerst het registernummer.
              - Druk daarna op **Debug Read HP1 register** of **Debug Read HP2 register**.
              - Resultaat verschijnt als `U16`, `S16` en raw bytes.

              </details>
            text_only: true
          - type: entities
            show_header_toggle: false
            entities:
              - entity: number.openquatt_debug_modbus_register
                name: Modbus register
              - entity: button.openquatt_debug_read_hp1_register
                name: Debug Read HP1 register
              - entity: button.openquatt_debug_read_hp2_register
                name: Debug Read HP2 register
              - entity: sensor.openquatt_debug_modbus_value_u16
                name: Result U16
              - entity: sensor.openquatt_debug_modbus_value_s16
                name: Result S16
              - entity: sensor.openquatt_debug_modbus_last_target
                name: Last target
              - entity: sensor.openquatt_debug_modbus_last_raw
                name: Last raw bytes
      - type: grid
        cards:
          - type: heading
            icon: mdi:radiator
            heading: Heating Curve diagnose
            heading_style: title
          - type: markdown
            content: |-
              <details>
              <summary><strong>Uitleg</strong></summary>

              Gebruik dit blok om de curve-regeling stap voor stap te controleren.

              - Deze sectie is vooral relevant bij `Heating mode = Curve`.
              - Vergelijk eerst `Supply target` met `Supply actual` om de regelafwijking te zien.
              - Controleer daarna de keten: `Demand curve raw (PID)` -> `Demand raw` -> `Demand filtered`.
              - `P_req` wordt in curve mode afgeleid uit demand en helpt bij CM3/tekort-logica.
              - `Curve Temp Deadband` en `Curve Demand Off Hold` zijn de
                belangrijkste anti-flip stabilisatie rond de nulvraag-rand.

              Let op: als `Supply actual` boven target zit maar demand hoog blijft, kijk dan naar PID-instellingen (`Kp/Ki/Kd`) en gedrag over tijd.

              </details>
            text_only: true
          - type: entities
            show_header_toggle: false
            entities:
              - entity: select.openquatt_heating_control_mode
                name: Heating mode
              - entity: climate.openquatt_heating_curve_pid
                name: Heating Curve PID
              - entity: button.openquatt_reset_heating_curve_pid_integral
                name: Reset PID integral
              - entity: sensor.openquatt_heating_curve_supply_target
                name: Supply target
              - entity: sensor.openquatt_water_supply_temp_selected
                name: Supply actual (selected)
              - entity: sensor.openquatt_demand_curve_raw
                name: Demand curve raw (PID)
              - entity: sensor.openquatt_demand_raw
                name: Demand raw
              - entity: sensor.openquatt_demand_filtered
                name: Demand filtered
              - entity: sensor.openquatt_power_house_p_req
                name: P_req
              - entity: number.openquatt_heating_curve_pid_kp
                name: PID Kp
              - entity: number.openquatt_heating_curve_pid_ki
                name: PID Ki
              - entity: number.openquatt_heating_curve_pid_kd
                name: PID Kd
              - entity: number.openquatt_curve_temp_deadband
                name: Curve Temp Deadband
              - entity: number.openquatt_curve_demand_off_hold
                name: Curve Demand Off Hold
          - type: history-graph
            title: Heating Curve temperatuur-lus (2 uur)
            hours_to_show: 2
            refresh_interval: 30
            entities:
              - entity: sensor.openquatt_heating_curve_supply_target
                name: Supply target
              - entity: sensor.openquatt_water_supply_temp_selected
                name: Supply actual
              - entity: sensor.openquatt_outside_temperature_selected
                name: Outside temp
            grid_options:
              columns: full
          - type: history-graph
            title: Heating Curve demand-keten (2 uur)
            hours_to_show: 2
            refresh_interval: 30
            entities:
              - entity: sensor.openquatt_demand_curve_raw
                name: Curve raw
              - entity: sensor.openquatt_demand_raw
                name: Demand raw
              - entity: sensor.openquatt_demand_filtered
                name: Demand filtered
            grid_options:
              columns: full
      - type: grid
        cards:
          - type: heading
            icon: mdi:home-lightning-bolt
            heading: Power House diagnose
            heading_style: title
          - type: markdown
            content: |-
              <details>

              <summary><strong>Uitleg</strong></summary>

              Gebruik dit blok om de Power House-regelketen te debuggen.

              - Relevant als `Heating mode = Power House`.
              - `P_house` is de modelschatting op basis van buitentemperatuur.
              - `P_req` is de begrensde warmtevraag na deadband/ramp-limiter.
              - `Effective room target` is kamersetpoint plus adaptieve comfort-bias.
              - `Comfort bias` en `room error avg` tonen de status van de adaptieve warm-bias regelaar.
              - `Demand raw` en `Demand filtered` zijn de 0..20 stapsignalen richting compressorregeling.
              - `Power cap demand` toont de actieve vraag na vermogensbegrenzing.
              - `Low-load dynamic thresholds` toont live de `pmin/off/on` drempels.
              - `Heat-enable state (shadow)` toont de shadow arbiter-status
                (`IDLE/PREHEAT/HEATING/POSTFLOW/LOCKOUT`) voor strategievalidatie.
              - `CM2 idle-exit reason` laat zien waarom idle-exit in deze cyclus
                timet, geblokkeerd is, of getript heeft.
              - `CM2 re-entry block active` toont of tijdelijke CM2-herstartblokkade
                nu actief is.

              Als `P_req` of demand onverwacht hoog/laag is: controleer buitenbron, kamer setpoint/temp en de ramp/deadband instellingen.

              </details>
            text_only: true
          - type: entities
            show_header_toggle: false
            entities:
              - entity: select.openquatt_heating_control_mode
                name: Heating mode
              - entity: sensor.openquatt_outside_temperature_selected
                name: Outside temp (selected)
              - entity: sensor.openquatt_room_setpoint_selected
                name: Room setpoint (selected)
              - entity: sensor.openquatt_room_temperature_selected
                name: Room temp (selected)
              - entity: sensor.openquatt_power_house_effective_room_target
                name: Effective room target
              - entity: sensor.openquatt_power_house_comfort_bias
                name: Comfort bias
              - entity: sensor.openquatt_power_house_room_error_avg
                name: Room error avg
              - entity: sensor.openquatt_power_house_p_house
                name: P_house
              - entity: sensor.openquatt_power_house_p_req
                name: P_req
              - entity: sensor.openquatt_low_load_dynamic_thresholds
                name: Low-load dynamic thresholds
              - entity: sensor.openquatt_heat_enable_state_shadow
                name: Heat-enable state (shadow)
              - entity: sensor.openquatt_cm2_idle_exit_reason
                name: CM2 idle-exit reason
              - entity: binary_sensor.openquatt_cm2_re_entry_block_active
                name: CM2 re-entry block active
              - entity: number.openquatt_low_load_off_fallback
                name: Low-load OFF fallback
              - entity: number.openquatt_low_load_on_fallback
                name: Low-load ON fallback
              - entity: number.openquatt_low_load_cm2_re_entry_block
                name: Low-load CM2 re-entry block
              - entity: sensor.openquatt_demand_raw
                name: Demand raw
              - entity: sensor.openquatt_demand_filtered
                name: Demand filtered
              - entity: sensor.openquatt_power_cap_demand
                name: Power cap demand
          - type: history-graph
            title: Power House model en input (2 uur)
            hours_to_show: 2
            refresh_interval: 30
            entities:
              - entity: sensor.openquatt_outside_temperature_selected
                name: Outside temp
              - entity: sensor.openquatt_room_setpoint_selected
                name: Room setpoint
              - entity: sensor.openquatt_room_temperature_selected
                name: Room temp
              - entity: sensor.openquatt_power_house_p_house
                name: P_house
            grid_options:
              columns: full
          - type: history-graph
            title: Power House output-keten (2 uur)
            hours_to_show: 2
            refresh_interval: 30
            entities:
              - entity: sensor.openquatt_power_house_p_req
                name: P_req
              - entity: sensor.openquatt_demand_raw
                name: Demand raw
              - entity: sensor.openquatt_demand_filtered
                name: Demand filtered
              - entity: sensor.openquatt_power_cap_demand
                name: Power cap demand
            grid_options:
              columns: full
    header:
      card:
        type: markdown
        content: >-
          # <ha-icon icon="mdi:flask-outline"></ha-icon> Debug & Testing

          Handmatige diagnose-tools voor tijdelijke metingen.
    cards: []
  - title: Diagnostics
    path: diagnostics
    icon: mdi:stethoscope
    type: sections
    max_columns: 3
    sections:
      - type: grid
        cards:
          - type: heading
            icon: mdi:tag-text
            heading: Versie informatie
            heading_style: title
          - type: markdown
            content: |-
              <details>

              <summary><strong>Uitleg</strong></summary>

              Dit blok toont firmwareversie en OTA-update-status:

              - `OpenQuatt Version`: versie die lokaal op de ESP draait
              (uit `project_version` in de build).
              - `Firmware Update`: vergelijkt jouw huidige firmware met de
              laatste GitHub release en toont of er een update beschikbaar is.
              - `Check Firmware Updates`: forceert direct een nieuwe updatecheck
              (zonder te wachten op de volgende automatische poll).

              Let op: bij een nieuwe release kan het kort duren voordat de
              update-entiteit de nieuwe versie toont (cache/refresh interval).

              </details>
            text_only: true
          - type: entities
            title: Version
            show_header_toggle: false
            entities:
              - entity: sensor.openquatt_openquatt_version
                name: OpenQuatt Version
              - entity: update.openquatt_firmware_update
                name: Firmware Update
              - entity: button.openquatt_check_firmware_updates
                name: Check Firmware Updates
      - type: grid
        cards:
          - type: heading
            icon: mdi:chip
            heading: Controller informatie
            heading_style: title
          - type: markdown
            content: |-
              <details>

              <summary><strong>Uitleg</strong></summary>

              Basis runtime-diagnostiek van de controller:

              - `Status`: online/offline van de ESP-node.
              - `Uptime`: tijd sinds laatste reboot.
              - `IP Address`: huidig netwerkadres.
              - `WiFi SSID`: verbonden draadloos netwerk.
              - `WiFi Signal`: RSSI-signaalsterkte in dBm.
              - `ESPHome Version`: versie van de ESPHome runtime.
              - `Restart`: herstart de controllernode vanuit Home Assistant.

              </details>
            text_only: true
          - type: entities
            title: Controller
            show_header_toggle: false
            entities:
              - entity: binary_sensor.openquatt_status
                name: Status
              - entity: sensor.openquatt_uptime
                name: Uptime
              - entity: sensor.openquatt_ip_address
                name: IP Address
              - entity: sensor.openquatt_wifi_ssid
                name: WiFi SSID
              - entity: sensor.openquatt_wifi_signal
                name: WiFi Signal
              - entity: sensor.openquatt_esphome_version
                name: ESPHome Version
              - entity: button.openquatt_restart
                name: Restart
    cards: []
    header:
      card:
        type: markdown
        content: >-
          # <ha-icon icon="mdi:stethoscope"></ha-icon> Diagnostics

          Controller- en firmwarediagnostiek, gericht op troubleshooting.
